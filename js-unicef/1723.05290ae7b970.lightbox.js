(self.funElementsApi=self.funElementsApi||[]).push([[1723],{50857:(t,e,i)=>{var o=i(37772).Symbol;t.exports=o},53366:(t,e,i)=>{var o=i(50857),s=i(62107),n=i(37157),r=o?o.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":r&&r in Object(t)?s(t):n(t)}},51242:(t,e,i)=>{var o="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g;t.exports=o},62107:(t,e,i)=>{var o=i(50857),s=Object.prototype,n=s.hasOwnProperty,r=s.toString,l=o?o.toStringTag:void 0;t.exports=function(t){var e=n.call(t,l),i=t[l];try{t[l]=void 0;var o=!0}catch(t){}var s=r.call(t);return o&&(e?t[l]=i:delete t[l]),s}},37157:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},37772:(t,e,i)=>{var o=i(51242),s="object"==typeof self&&self&&self.Object===Object&&self,n=o||s||Function("return this")();t.exports=n},86152:t=>{var e=Array.isArray;t.exports=e},15125:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},85505:(t,e,i)=>{var o=i(53366),s=i(86152),n=i(15125);t.exports=function(t){return"string"==typeof t||!s(t)&&n(t)&&"[object String]"==o(t)}},25388:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>y});var o=i(3056),s=i(86824),n=i(51540),r=i(22347),l=i(58642),a=i(23127);const h=["button","input","select","textarea","iframe","object","embed","a","[tabindex]","[href]","[contenteditable]"].join(", "),c=r.kJ().create({inject:["$element","$intl","$window"],computed:{element(){return this.$element},window(){return this.$window},intl(){return this.$intl},trapStartRefName:()=>"trapStart",trapStopRefName:()=>"trapEnd",buttonRefName:()=>"button",closeButtonRefName:()=>"closeButton",lightboxStyle(){return{background:this.lightboxStyleValues.bgColor,color:this.lightboxStyleValues.textColor,border:`${this.lightboxStyleValues.borderSize}px solid ${this.lightboxStyleValues.borderColor}`,borderRadius:this.lightboxStyleValues.borderRadius+"px",boxShadow:this.lightboxStyleValues.showShadow?"0 0 20px rgba(0, 0, 0, 0.4)":"none"}},buttonStyle(){return{backgroundColor:this.buttonStyleValues.buttonColor,borderStyle:"solid",borderRadius:this.buttonStyleValues.borderRadius+"px",borderColor:this.buttonStyleValues.borderColor,borderWidth:this.buttonStyleValues.borderSize+"px",color:this.buttonStyleValues.labelColor,boxShadow:this.buttonStyleValues.showShadow?"0 1px 4px rgba(0, 0, 0, 0.4)":"none"}},openAriaLabel(){return this.lightboxTitle?this.intl.translate("lightBox.openAriaLabelWithTitle",{title:this.lightboxTitle}):this.intl.translate("lightBox.openAriaLabelWithoutTitle")}},data:()=>({image:null,showImage:!1,buttonLabel:"",lightboxTitle:null,lightboxContent:"",lightboxStyleValues:{textColor:"",bgColor:"",borderColor:"",borderSize:0,borderRadius:0,showShadow:!1},buttonStyleValues:{labelColor:"",buttonColor:"",borderSize:0,borderRadius:0,borderColor:"",showShadow:!1},lastFocused:null,visible:!1,preventFocus:!1}),mounted(){this.setRenderingValues(this.element),this.element.setShowHandlers(this.onShow.bind(this),this.onHide.bind(this)),this.initialize()},methods:{onShow(){this.visible||(this.visible=!0,setTimeout((()=>{return t=this,e=void 0,o=function*(){yield function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500;return new Promise(((s,n)=>{let r=i,l=null;const a=()=>{l&&clearTimeout(l)},h=()=>{t===e()?(a(),s(!0)):0===r?(a(),n("Failed to focus")):(r-=1,t.focus(),l=setTimeout(h,o))};l=setTimeout(h,o)}))}(this.$refs[this.closeButtonRefName],(()=>this.getActiveElement()),10)},new((i=void 0)||(i=Promise))((function(s,n){function r(t){try{a(o.next(t))}catch(t){n(t)}}function l(t){try{a(o.throw(t))}catch(t){n(t)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,l)}a((o=o.apply(t,e||[])).next())}));var t,e,i,o})),this.window.addEventListener("keydown",this.handleEscape))},handleEscape(t){this.visible&&"Escape"===t.key&&this.hide()},onHide(){this.visible&&(this.visible=!1)},getActiveElement(){return this.window.document.activeElement},onFocusOutCloseBtn(){(0,l.Z)()&&this.visible&&this.focusNextElement()},onFocusOutDonateButton(){(0,l.Z)()&&this.visible&&this.focusNextElement({reverse:!0})},focusNextElement(){let{reverse:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.preventFocus)return;let e=[].slice.call(this.$el.querySelectorAll(h));t&&(e=e.reverse());for(let t=0;t<e.length;t++){const i=e[t],o=this.getActiveElement();if(i.focus(),o!==this.getActiveElement())break}},focusOut(t){this.visible&&!this.preventFocus&&(this.lastFocused=t.target)},focusIn(t){if(!this.visible||this.preventFocus)return;const e=this.$refs[this.trapStartRefName],i=this.$refs[this.trapStopRefName];t.target===e&&(this.lastFocused===i?this.focusNextElement():this.focusNextElement({reverse:!0})),t.target===i&&(this.lastFocused===e?this.focusNextElement({reverse:!0}):e.focus())},setRenderingValues(t){this.image=t.image,this.showImage=t.showImage,this.buttonLabel=t.buttonLabel,this.lightboxTitle=t.lightboxTitle,this.lightboxContent=t.lightboxContent,this.lightboxStyleValues=t.lightboxStyle,this.buttonStyleValues=t.buttonStyle,this.preventFocus=!t.canInteract||t.isMobile},initialize(){this.element.initialize()},handleDonateClick(){this.element.canInteract&&(this.element.hide({hideBackdrop:!1}),this.$root.$emit(a.N_.OPEN_WIDGET,this.element.getCheckoutOpenParams()))},hide(){this.element.canInteract&&this.element.hide({hideBackdrop:!0})},handleElementClick(){this.element.canInteract&&this.$root.$emit(a.N_.CLICK)},update(){this.setRenderingValues(this.element)}},render(){const t=arguments[0];var e;return t("div",{class:"screen"},[t("div",{class:"container",on:{focusin:this.focusIn,focusout:this.focusOut}},[t("div",{class:"lightbox-gutter"},[this.visible&&t("div",{attrs:{tabIndex:"0","aria-hidden":!0},ref:this.trapStartRefName}),t("div",{attrs:{role:"dialog","aria-label":this.openAriaLabel},class:"lightbox",style:Object.assign({},this.lightboxStyle),on:{click:r.LY.stop(this.handleElementClick)}},[t("button",{class:"close-btn",ref:this.closeButtonRefName,on:{click:r.LY.stop(this.hide),focusout:this.onFocusOutCloseBtn},attrs:{"aria-label":this.intl.translate("lightBox.closeAriaLabel"),"data-qa":"lightbox-close-button"}},[t("svg",{attrs:{"aria-hidden":"true",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{d:"M15 5L5 15",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}}),t("path",{attrs:{d:"M5 5L15 15",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}})])]),this.showImage&&t("img",{attrs:{src:null!==(e=this.image)&&void 0!==e?e:"",alt:"",width:o.Nw.WIDTH,height:o.Nw.HEIGHT,"data-testid":"lightbox-image","data-qa":"lightbox-image"},class:"image"}),t("div",{class:this.showImage?"body-show-image":"body-hide-image"},[this.lightboxTitle&&t("h2",{class:"title",attrs:{dir:"auto","data-testid":"lightbox-title"}},[this.lightboxTitle]),this.lightboxContent&&t("div",{class:"content",domProps:{innerHTML:this.lightboxContent},attrs:{dir:"auto","data-testid":"lightbox-content",role:"status"}}),t("div",{class:"cta"},[t("button",{attrs:{type:"button",dir:"auto","data-testid":"lightbox-button","data-qa":"lightbox-donate-button"},class:"cta-btn",on:{click:r.LY.stop(this.handleDonateClick),focusout:this.onFocusOutDonateButton},style:this.buttonStyle,ref:this.buttonRefName},[t("span",{class:"cta-btn-label"},[this.buttonLabel||"Â "]),t("span",{class:"cta-btn-hover-bg",style:{backgroundColor:this.buttonStyle.color},attrs:{"aria-hidden":!0}})])])])]),this.visible&&t("div",{attrs:{tabIndex:"0","aria-hidden":!0},ref:this.trapStopRefName})])])])}});var u=i(73613),d=i(66443),b=i(72005);function g(t,e,i){switch(t){case"onLoad":return new f;case"onTimeout":return new p(i.timeoutStrategy);case"onScroll":return new w;case"onInactivity":return new x(i.inactivityStrategy);case"onExit":return new v(e);default:throw new Error(`Unknown key "${t}"`)}}class m{constructor(){this._handler=null}get handler(){if(!this._handler)throw new Error("Open Handler was not set");return this._handler}open(){this.handler(),this.destroy()}observe(t){this._handler=t}}class f extends m{constructor(){super(...arguments),this.algorithm="onLoad"}observe(t){super.observe(t),this.open()}destroy(){}}class p extends m{constructor(t){super(),this.algorithm="onTimeout",this.timeout=null,this.OPEN_TIMEOUT=t}observe(t){super.observe(t),this.timeout=setTimeout((()=>{this.open()}),this.OPEN_TIMEOUT)}destroy(){this.timeout&&clearTimeout(this.timeout)}}class w extends m{constructor(){super(...arguments),this.algorithm="onScroll",this.listener=null}observe(t){super.observe(t),this.listener=(0,u.P)((()=>this.handleScroll()),500),document.addEventListener("scroll",this.listener)}destroy(){this.listener&&document.removeEventListener("scroll",this.listener)}handleScroll(){const t=document.documentElement,e=document.body;(t.scrollTop||e.scrollTop)/((t.scrollHeight||e.scrollHeight)-t.clientHeight)*100>=w.PERCENT_THRESHOLD&&this.open()}}w.PERCENT_THRESHOLD=35;class x extends m{constructor(t){super(),this.algorithm="onInactivity",this.removeListener=null,this.userInteraction=null,this.timeout=null,this.OPEN_TIMEOUT=t}observe(t){super.observe(t),this.userInteraction=new d.D(window);const e=()=>this.handleActivity();this.removeListener=this.userInteraction.subscribeOnUserInteraction(e),e()}handleActivity(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.timeout=setTimeout((()=>{this.open()}),this.OPEN_TIMEOUT)}destroy(){this.removeListener&&(this.removeListener(),this.removeListener=null),this.userInteraction&&(this.userInteraction=null),this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}}class v extends m{constructor(t){super(),this.isMobile=t,this.algorithm="onExit",this.listener=null}observe(t){this.isMobile||(super.observe(t),this.listener=(0,u.P)((t=>this.handleExit(t)),500),window.document.addEventListener("mouseout",this.listener))}handleExit(t){const e=t||window.event,i=e.relatedTarget||e.toElement;i&&"HTML"!==i.fromNode&&"HTML"!==i.nodeName||this.open()}destroy(){this.listener&&window.document.removeEventListener("mouseout",this.listener)}}var S=i(1563);class y extends((0,S.a)(c)){constructor(t){super(t),this.init=!1,this.isLoaded=!1;const e=this.api.getOpenStrategy(t.elementKey),i={onExit:this.config.allowToShowOnExit,onInactivity:this.config.allowToShowOnInactivity,onLoad:this.config.allowToShowOnLoad,onScroll:this.config.allowToShowOnScroll,onTimeout:this.config.allowToShowOnTimeout};this.strategy=function(t,e,i,o,s){if(s)return new f;if(o&&t[o])return g(o,e,i);const n=function(t,e,i){const o=[];for(const[s,n]of Object.entries(t))if(n){const t=g(s,e,i);o.push(t)}return o}(t,e,i);return n[(0,b.v)(0,n.length-1)]}(i,this.isMobile,function(t,e){const i={timeoutStrategy:8*s.MS.SECOND,inactivityStrategy:20*s.MS.SECOND};return e!==n.CB.PRODUCTION?{timeoutStrategy:t.FUN_LIGHTBOX_TIMEOUT_STRATEGY_MS||i.timeoutStrategy,inactivityStrategy:t.FUN_LIGHTBOX_INACTIVITY_STRATEGY_MS||i.inactivityStrategy}:i}(window,this.env),e,this.showcase),e&&i[e]||this.api.setOpenStrategy(t.elementKey,this.strategy.algorithm),this.api.isInteractionExpired&&this.tracker.customTrack({type:"popupElementInitialized",data:{openingStrategy:this.strategy.algorithm,campaignKey:this.widgetKey,elementKey:this.elementKey}})}get showImage(){return this.config.showLightboxImage}get image(){const t=o.Nw.WIDTH,e=2*t,i=`https://ucarecdn.com/7a2a472d-06d6-48fc-8c7d-37e313b717e0/-/resize/${e}x/-/format/auto/`;if(!this.config.showLightboxImage)return null;if(!this.config.lightboxImage)return i;const s=window.devicePixelRatio>1?`${e}x`:`${t}x`;return`https://ucarecdn.com/${this.config.lightboxImage.uuid}/-/resize/${s}/-/format/auto/`}get canInteract(){return!this.showcase}get lightboxTitle(){return this.getConfigLocalization().lightboxTitle}get lightboxContent(){return this.getConfigLocalization().lightboxContent}get buttonLabel(){return this.getConfigLocalization().buttonLabel}get lightboxStyle(){return{textColor:this.config.lightboxTextColor,bgColor:this.config.lightboxBackgroundColor,borderColor:this.config.lightboxBorderColor,borderSize:this.config.lightboxBorderSize,borderRadius:this.config.lightboxBorderRadius,showShadow:this.config.lightboxShadow}}get buttonStyle(){return{labelColor:this.config.buttonLabelColor,buttonColor:this.config.buttonColor,borderColor:this.config.buttonBorderColor,borderSize:this.config.buttonBorderSize,borderRadius:this.config.buttonBorderRadius,showShadow:this.config.buttonShadow}}render(){return super.render(),this}initialize(){this.baseIframe.setStyles([["display","block"]]),this.canShow&&this.strategy.observe((()=>this.show()))}setShowHandlers(t,e){this.onShow=t,this.onHide=e,this.baseIframe.addOnLoadHandler((()=>{this.isLoaded=!0,this.onShow&&this.init&&this.onShow()}))}show(){this.api.isWidgetOpen||(this.onClickIframe((()=>{this.hide({hideBackdrop:!0})})),this.api.beforeAppear({hideBackdrop:this.showcase}),this.baseIframe.showDocument(),this.baseIframe.resize({width:"100%",height:"100%"}),this.baseIframe.setStyles([["display","block"],["position",this.showcase?"static":"fixed"],["top","0%"],["left","0%"],["z-index",2147483647],["width","100%"],["height",this.iframeMaxHeight],["transform","translateZ(100px)"]]),this.init=!0,this.viewportTracker&&(this.viewportTracker.elementData=this.getElementTrackingData()),this.isLoaded&&this.onShow&&this.onShow())}hide(t){this.showcase||(this.api.beforeHide(t),this.baseIframe.setStyles([["display","none"],["padding","0"]]),this.onClose(),this.init=!1,this.onHide&&this.onHide())}getCheckoutOpenParams(){return{customFields:this.config.customFields}}getElementTrackingData(){const t={onLoad:this.config.allowToShowOnLoad,onTimeout:this.config.allowToShowOnTimeout,onScroll:this.config.allowToShowOnScroll,onInactivity:this.config.allowToShowOnInactivity,onExit:this.config.allowToShowOnExit};return{hasImage:!!this.config.showLightboxImage,hasTitle:!!this.lightboxTitle,donateButtonText:this.buttonLabel,lightboxType:this.strategy.algorithm,availableLightboxTypes:Object.keys(t).filter((e=>t[e]))}}updateConfig(t){var e;super.updateConfig(t),null===(e=this.vueApp)||void 0===e||e.update()}get canShow(){return window.FUN_FORCE_GLOBAL_ELEMENT===this.elementKey||this.showcase||this.api.isInteractionExpired&&this.api.isSuccessDonationExpired}get api(){return this.getApi(4)}get baseIframe(){if(!this.iframe)throw new Error("Iframe not found");return this.iframe}get iframeMaxHeight(){return this.showcase?this.lightboxTitle||this.config.showLightboxImage?this.config.showLightboxImage?"700px":"500px":"400px":"100%"}onClickIframe(t){this.baseIframe.iframeDocument&&(this.baseIframe.iframeDocument.onclick=()=>{t()})}onClose(){this.trackElementClose()}}}}]);